import numpy as np

x11 = 5
x12 = 5

x21 = 10
x22 = 10

F = np.array([
    (x11 + x21)/2,
    (x12 + x22)/2,
    np.arctan2((x21-x11), (x22-x12))
])

d = (x11-x21)**2 + (x12 - x22)**2

J = np.array([
    [0.5, 0.0, 0.5, 0.0],
    [0.0, 0.5, 0.0, 0.5],
    [(x11-x22)/d, (x21-x11)/d, (x22-x12)/d, (x11-x21)/d]
])

C_x = np.array([
    [4.0, 0.0, 0.0, 0.0],
    [0.0, 4.0, 0.0, 0.0],
    [0.0, 0.0, 4.0, 0.0],
    [0.0, 0.0, 0.0, 4.0]
])

C_F = J @ C_x @ J.T

print("F =")
print(F)
print("-----------------------")
print("C_F =")
print(C_F)
