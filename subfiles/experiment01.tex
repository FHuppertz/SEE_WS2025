%!TEX root = ../report.tex
\documentclass[../report.tex]{subfiles}

\begin{document}
\section{Manual Motion Observation}
\label{sec:exp01}
The goal of this experiment is to design a differntial drive robot using LEGO EV3 and then measure its pose variation for three different constant velocity motions: an arc to the left, straight line ahead, and an arc to the right.
\subsection{Design of Experiment}
PUT DESIGN IMAGES AND TEXT HERE AND HOW TO MEASURE POSE AND ENSURE START POSITION

\subsection{Estimates of the expected Precision}
PUT ERROR DUE TO MEASUREING HERE

\subsection{Jacobian Error Propagation}
Let $F$ be a vector function to calculate the end pose using two measured positions, $\mathbf{x}_1$ and $\mathbf{x}_2$.
The definition of these input vectors and the function can be seen in Equations \ref{eq:x1x2} to \ref{eq:F}.

\begin{eqnarray}
	\mathbf{x}_1 &=& \begin{pmatrix} x_{1,1} \\ x_{1,2} \end{pmatrix} \label{eq:x1x2} \\
	\mathbf{x}_2 &=& \begin{pmatrix} x_{2,1} \\ x_{2,2} \end{pmatrix} \\
	\mathbf{F}(\mathbf{x}_1, \mathbf{x}_2) &=& \begin{pmatrix} \frac{1}{2}(x_{1,1} + x_{2,1}) \\
		\frac{1}{2}(x_{1,2} + x_{2,2}) \\  \arctan(\frac{x_{1,1}-x_{2,1}}{x_{1,2}-x_{2,2}})\end{pmatrix} \label{eq:F}
\end{eqnarray}

To propagate the error from measuremnts of $x_1$ and $x_2$ the Jacobian matrix $\mathbf{J}$ needs to be calculated. Here, the Jacobian matrix $\mathbf{J}$ is a $2 \times 4$ matrix which can be seen in Equations \ref{eq:Jac} to \ref{eq:Jac_end}.

\begin{eqnarray}
	\mathbf{J} &=&
	\begin{pmatrix}
		\frac{\partial F_1}{\partial x_{1,1}} & \frac{\partial F_1}{\partial x_{1,2}} & \frac{\partial F_1}{\partial x_{2,1}} & \frac{\partial F_1}{\partial x_{2,2}} \\
		\frac{\partial F_2}{\partial x_{1,1}} & \frac{\partial F_2}{\partial x_{1,2}} & \frac{\partial F_2}{\partial x_{2,1}} & \frac{\partial F_2}{\partial x_{2,2}} \\
		\frac{\partial F_3}{\partial x_{1,1}} & \frac{\partial F_3}{\partial x_{1,2}} & \frac{\partial F_3}{\partial x_{2,1}} & \frac{\partial F_3}{\partial x_{2,2}}
	\end{pmatrix} \label{eq:Jac} \\
	&=& \begin{pmatrix}
		\frac{1}{2}               & 0                         & \frac{1}{2}               & 0                         \\
		0                         & \frac{1}{2}               & 0                         & \frac{1}{2}               \\
		\frac{x_{1,2}-x_{2,2}}{D} & \frac{x_{2,1}-x_{1,1}}{D} & \frac{x_{2,2}-x_{1,2}}{D} & \frac{x_{1,1}-x_{2,1}}{D}
	\end{pmatrix} \\
	D &=& (x_{1,1}-x_{2,1})^2+(x_{1,2}-x_{2,2})^2 \label{eq:Jac_end}
\end{eqnarray}

\subsection*{Error Propagation Formula}
The covariance matrix of the result $\mathbf{C}_F$ is related to the covariance matrix of the inputs $\mathbf{C}_x$ by the formula:

$$
	\mathbf{C}_F = \mathbf{J} \, \mathbf{C}_x \, \mathbf{J}^T
$$

where $\mathbf{C}_x$ is the $4 \times 4$ covariance matrix for the input vector $\mathbf{x} = (x_{1,1}, x_{1,2}, x_{2,1}, x_{2,2})^T$.
\begin{itemize}
	\item The diagonal elements of $\mathbf{C}_F$ give the **variances** of $F_1$ and $F_2$: $\mathbf{C}_F(i, i) = \sigma_{F_i}^2$.
	\item The off-diagonal elements of $\mathbf{C}_F$ give the **covariances** between $F_1$ and $F_2$.
\end{itemize}

\end{document}
